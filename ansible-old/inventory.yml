all:
  children:
    production:
      hosts:
        production-server:
          ansible_host: "{{ lookup('env', 'SERVER_IP', default='65.108.157.187') }}"
          ansible_user: "{{ lookup('env', 'ANSIBLE_USER', default='postgres') }}"
          ansible_ssh_private_key_file: "{{ lookup('env', 'SSH_KEY_FILE', default='~/.ssh/super-app-backend') }}"
          ansible_ssh_common_args: '-o StrictHostKeyChecking=no'
          ansible_become: yes
          ansible_become_user: root
          ansible_become_method: sudo
      vars:
        ansible_python_interpreter: /usr/bin/python3

    # Group for initial server setup (root user)
    initial_setup:
      hosts:
        initial-server:
          ansible_host: "{{ lookup('env', 'SERVER_IP', default='65.108.157.187') }}"
          ansible_user: "root"
          ansible_ssh_private_key_file: "{{ lookup('env', 'SSH_KEY_FILE', default='~/.ssh/id_rsa') }}"
          ansible_ssh_common_args: '-o StrictHostKeyChecking=no'
      vars:
        ansible_python_interpreter: /usr/bin/python3

    # Group for local development
    local_dev:
      hosts:
        localhost:
          ansible_connection: local
          ansible_host: "127.0.0.1"
      vars:
        ansible_python_interpreter: /usr/bin/python3